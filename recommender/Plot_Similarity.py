import matplotlib.pyplot as plt
import numpy as np

epochs = np.arange(0,100,1)

cos = np.array([0.1455060902537813, 0.13805422777535697, 0.1307174072347804, 0.12340485482039452, 0.11612615693115666, 0.10886045013095515, 0.10162619372281378, 0.09447013276673649, 0.0873909619860156, 0.0803923277459034, 0.07352789806548196, 0.06677329839264347, 0.0601347746402269, 0.05378027253466855, 0.04762330389146521, 0.01730395491894669, 0.005664014293748728, 0.0011187715515530658, 0.0003880966240037505, 0.00022078194653691677, 0.00015984314967358433, 0.00016724453747814444, 0.00016023395922343223, 0.00015689387917784445, 0.00015922740951164317, 0.0001525682887151998, 0.00014568975230932872, 0.00014923329488577782, 0.00014490763367139295, 0.00014286491396073308, 0.00013634114253431438, 0.00013597709736884868, 0.00013679421521095857, 0.0001366171427984842, 0.000137202701837512, 0.0001371097578843206, 0.00013636809690416809, 0.00013590851108016174, 0.000135709071999852, 0.0001358190683197508, 0.00013670161399391908, 0.0001359856824606197, 0.00013611025666250467, 0.00013598534480310011, 0.00013537590791890948, 0.00014190024463447748, 0.00014181193435085625, 0.00014254433807438016, 0.00014262784958003977, 0.00014204142413451625, 0.0001424007087523482, 0.000141942905071558, 0.00014263547022493774, 0.00014158282035889953, 0.00014228215231002148, 0.0001423423764078328, 0.00014230655120027965, 0.0001417202474986657, 0.0001423189549778836, 0.0001418495615851184, 0.00013482970579974162, 0.00013494601807261498, 0.00013435991339682778, 0.0001350387084878457, 0.00013466175408710158, 0.00013471969114393025, 0.00013435880842727332, 0.0001352212801426377, 0.00013501388965575896, 0.000135163685666582, 0.00014253518888432875, 0.00014267204480062723, 0.00014246786832080758, 0.00014181006485689126, 0.0001423275886911842, 0.00023381734846755225, 0.00023629178293374438, 0.00023358140990518592, 0.00023082293860280954, 0.0002348030891045122, 0.0002329340193021218, 0.00023548628209844053, 0.00023418714770805113, 0.0002335876748965237, 0.00023509537787322267, 0.00023978187776858918, 0.00023056694736718047, 0.00023705076796532256, 0.00023371758439083763, 0.00023600280481990603, 0.00014178362568815074, 0.0001424100596003842, 0.00014226727570328142, 0.0001423078778281667, 0.00014231253138067196, 0.00014224405630439908, 0.00014201168846665285, 0.00014180309948236402, 0.00014247060880688014, 0.00014223766118792684])

acos = np.array([1.4605214820579582, 1.4530600155852933, 1.4455839810654931, 1.4381016026468427, 1.430661175531872, 1.4232442223464883, 1.4157755014397675, 1.408331004510695, 1.4008360698895557, 1.393403092126216, 1.3859596813373627, 1.3785108405937172, 1.3709965458430968, 1.3635365629442298, 1.3561031902838332, 1.2800067209414134, 1.1999246005687967, 1.1087124750692412, 1.0023739245592909, 0.8811577598345944, 0.7464468337125946, 0.6003185712560363, 0.44615538106501185, 0.2924458020256593, 0.16390048811998806, 0.09111829477891836, 0.05672391857689076, 0.043883934461091206, 0.04029414740941919, 0.038072716156189366, 0.03771437094160895, 0.037329540716800114, 0.03689229350305656, 0.03646989651905934, 0.03599381458001625, 0.03548888258803942, 0.03496911573208767, 0.03433269458096539, 0.033802246515176576, 0.03310773829717945, 0.032507131681235986, 0.031840447775578186, 0.03110484032615243, 0.030381494455490026, 0.029636767822909808, 0.024398300665865708, 0.019871437402547574, 0.01696652302696808, 0.014992988541323613, 0.013209352680578806, 0.011187116917577164, 0.009259026076669424, 0.007527339052220246, 0.006389244709253969, 0.005258699197415517, 0.004411233498473062, 0.003866419983266984, 0.003352510128274747, 0.0030129039646206632, 0.0025853880977912314, 0.0025968267885534417, 0.0023617334345021686, 0.0024393763470905634, 0.002446326790521287, 0.00236892380898169, 0.002383510980837323, 0.002337467267936884, 0.002332033819076072, 0.0022118151509269877, 0.0021820325063962296, 0.0020489491276483446, 0.0017547786115035713, 0.0017940779644899847, 0.0015294260525093434, 0.0015145710803585138, 0.0010664335390644368, 0.0007797632352005067, 0.0007491556756741436, 0.00048344833244016723, 0.00041784694665789545, 0.00039401633228495695, 0.00022890642063963748, 0.0001874886239791678, 0.00014983750648058606, 0.00015311860081439907, 0.0001602001136002584, 0.0001535270608932051, 0.0001640962134023843, 0.00016158910070806462, 0.0001487410903880667, 1.5093434238526117e-06, 1.520374739536083e-05, 1.595607520696179e-05, 1.512570972872184e-05, 1.666597758392595e-05, 1.4866657261766547e-05, 1.4374577437560192e-05, 1.6249750803260224e-05, 1.5689871765419762e-05, 1.4908337043602826e-05])

amsd =  np.array([0.322741520344831, 0.31523458738765786, 0.30783615706738315, 0.30033828221532116, 0.2928674215734098, 0.2856237110450467, 0.27817463469447107, 0.2708231602531739, 0.2633448541118508, 0.25598156312988807, 0.2485797250735205, 0.24130833844151772, 0.23381393223729452, 0.22645716388021297, 0.2190496167065805, 0.15064379150216245, 0.08753918854517237, 0.04350744713018251, 0.02908259063905119, 0.026461212937614574, 0.025207809640101532, 0.024795031201763677, 0.02460244039481623, 0.024575354975162098, 0.024937238637690193, 0.024387449790624637, 0.02480317577532296, 0.024712040377997888, 0.02456237534782744, 0.02484190292498743, 0.024033414066105513, 0.02449864996219821, 0.025779148228021014, 0.02475759199713372, 0.02462731221945911, 0.024296221700681613, 0.02464648626940389, 0.024605014715885283, 0.02466838907959185, 0.023712482353338254, 0.0248874129461817, 0.02529326017738325, 0.025312757190191108, 0.024229419198193197, 0.025232147785072087, 0.02469123610169854, 0.025250847848156007, 0.025270339370951776, 0.024688827622052968, 0.025442121057788352, 0.024883426064181376, 0.024775052945115696, 0.024338230556940246, 0.02470933101988333, 0.025291197098013828, 0.024160654918024528, 0.024471685695820627, 0.024752912297067345, 0.025506594039339005, 0.02501542277333183, 0.02504087935035519, 0.024518404144045873, 0.025123040883043478, 0.024733475980704082, 0.025694944255444618, 0.02445102443889094, 0.024972062593134604, 0.024841537917789962, 0.024799923732140464, 0.024469486460185458, 0.024427086694189182, 0.024600220206225244, 0.02499072525475466, 0.02416336712094279, 0.024728937558675192, 0.025626362739161468, 0.02481786459620998, 0.02487820367976894, 0.025251758642253055, 0.025569324902621326, 0.024442687610342892, 0.024451201377961133, 0.025121991895353593, 0.02478887110327459, 0.025160912855934754, 0.025019381784963733, 0.024475929130138036, 0.025387378542622907, 0.025249180808456038, 0.025257017567543935, 0.025441319559175713, 0.023936949902522788, 0.024579121092426142, 0.024181477759324086, 0.02497158500254598, 0.024816853408434304, 0.024025131818510348, 0.025482194736656853, 0.025902921449237098, 0.024970767818853823])

amsd_no1s = np.array([0.9544529780895573, 0.9453435310412313, 0.936160845596875, 0.9270547273137169, 0.9179480628499098, 0.90886227033254, 0.899697024095458, 0.8905835569719069, 0.8814266925165848, 0.8723177479797247, 0.86316220133318, 0.8540656143451654, 0.8449007003960577, 0.8357790576727575, 0.8266213002226135, 0.7369372286122772, 0.6419561837051371, 0.5323871241783215, 0.4061183148214721, 0.2676060997312798, 0.1324587624268574, 0.05262022909332035, 0.023752944377089982, 0.010235388845975241, 0.005787988410244658, 0.004191261999704419, 0.004131662750058978, 0.004157115058190356, 0.0035211886113031073, 0.0027861989170508746, 0.002657546597681768, 0.002630959209690611, 0.002481928003394983, 0.0024744490959855204, 0.0024029907384008685, 0.0023569920784831553, 0.002300550024740722, 0.002232817140134229, 0.002146038327603372, 0.0021633755461335667, 0.0020846180064671574, 0.0020120765523739793, 0.002013279608770271, 0.0019399927852836254, 0.0018645563569063075, 0.0015847570601611682, 0.001325684087847617, 0.001218565677890238, 0.0011758091433682282, 0.001086683493032906, 0.0010848765989887772, 0.0010612466013215091, 0.0010550879545795622, 0.0010695501680288017, 0.001063789041522801, 0.0010156645769666547, 0.0010158999832018116, 0.0010232692611049118, 0.0010029242034039637, 0.0010010950150246254, 0.0009492338610731644, 0.0010015083397582804, 0.0009611921242865569, 0.000976779330116781, 0.0009471271887982245, 0.0009912840984224107, 0.0009854359226222668, 0.0009632803749029786, 0.0009363051605359465, 0.0009671619904210528, 0.0009597213657278661, 0.0009843868396824122, 0.0009712169059922813, 0.0009679341096395706, 0.0009495459595030023, 0.0009302650882799004, 0.0009614931353011192, 0.000972932805013865, 0.0009624382104814863, 0.0009376921446406032, 0.0009553450326081082, 0.0009491726503906876, 0.0009179779484592027, 0.0009584032318753175, 0.0009170969484454219, 0.0009452049651103283, 0.0009206017300756501, 0.0009140122012410541, 0.0009244808241620165, 0.0009191382506874215, 0.0009061892143773415, 0.0009152011856918581, 0.000904697987675712, 0.000918656128035741, 0.0009209030546035754, 0.0009192600665932342, 0.0009100593761743842, 0.0009164511776116536, 0.0009071184350129402, 0.0008949173694731908])

'''
plt.plot(epochs, amsd_no1s, label='AMSD 1sR')
#plt.legend()
plt.gca().set_ylim(bottom=0)
plt.gca().set_ylim(top=0.01)
plt.xlabel('epochs')
plt.ylabel('validation error')
plt.show()
'''

# SVD RESULTS
# using no1s

amsd_no1s = '''
    Validation error    = 0.0008967842923519925
    Mean similarity     = 0.0004945109831169248
    Ratio               = 1.8134769964
    Saved model: 20210602172802
    '''

amsd = '''
    Validation error    = 0.024970793601743913
    Mean similarity     = 0.0011713268468156457
    Ratio               = 21.3183823709
    Saved model: 20210527210212
    '''

acos_no1s = '''
    Validation error    = 1.5866828512981146e-05
    Mean similarity     = 1.9500615167089563e-07
    Ratio               = 81.3657844997
    Saved model: 20210527232304
    '''

acos = '''
    Validation error    = 0.02524098681073395
    Mean similarity     = 0.0006010105134919286
    Ratio               = 41.9975794833
    Saved model: 20210527232329
    '''

cos_no1s = '''
    Validation error    = 0.0008451946375879134
    Mean similarity     = 0.00017452312749810517
    Ratio               = 4.842880423381
    Saved model: 20210603205401
    '''

cos = '''
    Validation error    = 0.025236495017752873
    Mean similarity     = 0.0000011611408581302385
    Ratio               = 21734.223579377
    Saved model: 20210527232304
    '''


# Learning rates plot
lrs = [1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-05, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06, 1e-06]


plt.plot(epochs, lrs)
plt.xlabel('epochs')
plt.ylabel('learning rate')
plt.annotate('1e-05', 
            xy=(100, 1e-05), 
            xytext=(105, 1e-5))
plt.annotate('1e-06', 
            xy=(100, 1e-06), 
            xytext=(105, 1e-6))
plt.show()



# Prediction Model Accuracy

amsd_no1s = '''

    '''
    
acos_no1s = '''

    '''
    
cos_no1s = '''

    '''